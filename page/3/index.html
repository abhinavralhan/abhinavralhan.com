---
layout: default
---
{% include sidebar-nav.html %}

<h2 class="page-title">Blog</h2>

<input type="text" id="search-input" placeholder="Search postsâ€¦">
<div id="results"></div>
<p id="no-results" style="text-align:center; color:#888; display:none;">No posts found</p>

<div class="pagination" id="pagination"></div>

<script>
var posts = [{% for post in site.posts %}{title:{{ post.title | jsonify }},url:"{{ post.url }}",date:"{{ post.date | date: '%B %d, %Y' }}",excerpt:{{ post.content | strip_html | truncate: 160 | jsonify }}}{% unless forloop.last %},{% endunless %}{% endfor %}];
var page = 3;
var perPage = 3, start = (page-1)*perPage, show = posts.slice(start, start+perPage), total = Math.ceil(posts.length/perPage);

function render(p) {
  var r = document.getElementById('results'), n = document.getElementById('no-results');
  if (!p.length) { n.style.display='block'; r.innerHTML=''; return; }
  n.style.display='none';
  r.innerHTML = p.map(function(x){return '<div class="card"><h3><a href="'+x.url+'">'+x.title+'</a></h3><small>'+x.date+'</small><p>'+x.excerpt+'...</p></div>';}).join('');
}

// Build numbered pagination
var pag = '';
for (var i = 1; i <= total; i++) {
  var url = i === 1 ? '/' : '/page/' + i + '/';
  if (i === page) {
    pag += '<span class="page-num current">' + i + '</span>';
  } else {
    pag += '<a href="' + url + '" class="page-num">' + i + '</a>';
  }
}
document.getElementById('pagination').innerHTML = pag;

render(show);

document.getElementById('search-input').addEventListener('input', function(){
  var q = this.value.toLowerCase().trim();
  render(q ? posts.filter(function(p){return p.title.toLowerCase().includes(q)||p.excerpt.toLowerCase().includes(q);}) : show);
});
</script>
